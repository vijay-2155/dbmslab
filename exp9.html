<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Lab Experiments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Prism CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    
    <style>
        .token.keyword { color: #569CD6; }
        .token.string { color: #CE9178; }
        .token.number { color: #B5CEA8; }
        .token.function { color: #DCDCAA; }
        .language-sql { color: #D4D4D4; }
        pre[class*="language-"] {
            background: #1E1E1E !important;
            margin: 0;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex flex-col md:flex-row min-h-screen">
        <div id="sidebar" class="hidden md:block w-full md:w-72 bg-gradient-to-b from-gray-800 to-gray-900 text-white p-6 shadow-xl">
            <!-- Sidebar content will be generated by JavaScript -->
        </div>

        <div class="flex-1 p-4 md:p-8 overflow-y-auto">
            <div class="max-w-4xl mx-auto">
                <!-- Header -->
                <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-8">
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Experiment 8: Procedures in PL/SQL</h1>
                    <div class="flex flex-col md:flex-row items-start md:items-center text-sm text-gray-500">
                        <span class="mb-2 md:mb-0 md:mr-4">üìÖ Date: May 5, 2025</span>
                        <span>‚è±Ô∏è Duration: 2 hours</span>
                    </div>
                </div>

                <!-- Aim Section -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Aim</h2>
                    <p class="text-gray-600">
                        To understand and implement PL/SQL procedures with IN and OUT parameters for data manipulation and retrieval.
                    </p>
                </section>

                <!-- Theory Section -->
                <section class="mb-8 bg-white p-6 rounded-lg shadow-lg">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Theory</h2>
                    <div class="space-y-4">
                        <p class="text-gray-600">
                            Procedures in PL/SQL are named blocks of code that can accept parameters and be called multiple times. Parameters can be:
                        </p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <h3 class="text-blue-600 font-semibold mb-2">IN Parameters</h3>
                                <p class="text-gray-600">Pass values into the procedure. These are read-only within the procedure.</p>
                            </div>

                            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <h3 class="text-green-600 font-semibold mb-2">OUT Parameters</h3>
                                <p class="text-gray-600">Return values from the procedure. These can be modified within the procedure.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Syntax Reference Section -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Syntax Reference</h2>
                    
                    <!-- Basic Procedure Syntax -->
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
-- Basic Procedure Structure
CREATE [OR REPLACE] PROCEDURE procedure_name 
    [(parameter_name [IN | OUT | IN OUT] datatype [, ...])]
IS|AS
    -- Declaration section
    [local variables, cursors, exceptions]
BEGIN
    -- Executable section
    [statements]
[EXCEPTION]
    -- Exception handling section
    [WHEN exception THEN statements]
END [procedure_name];
/

-- Calling a Procedure
BEGIN
    procedure_name[(parameters)];
END;
/

-- Or from SQL*Plus
EXECUTE procedure_name[(parameters)];</code></pre>
                    </div>

                    <!-- Parameter Types Syntax -->
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
-- Examples of Different Parameter Types
CREATE OR REPLACE PROCEDURE example_proc (
    p_in_param    IN     NUMBER,       -- Input parameter
    p_out_param   OUT    VARCHAR2,     -- Output parameter
    p_inout_param IN OUT DATE          -- Input/Output parameter
)
IS
    v_local_var NUMBER;                -- Local variable
BEGIN
    -- Procedure body
    NULL;
END;
/

-- Dropping a Procedure
DROP PROCEDURE procedure_name;</code></pre>
                    </div>

                    <!-- Key Points Box -->
                    <div class="bg-blue-50 p-4 rounded-lg mt-4">
                        <h3 class="text-blue-800 font-semibold mb-2">Important Notes:</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li>IN parameters are read-only (default if not specified)</li>
                            <li>OUT parameters must be assigned a value in the procedure</li>
                            <li>IN OUT parameters can be both read and modified</li>
                            <li>Parameters can have default values</li>
                            <li>Procedure name must be unique within the schema</li>
                        </ul>
                    </div>
                </section>

                <!-- Example Code -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Implementation Examples</h2>
                    
                    <!-- Program 1: Basic Student Management -->
                    <div class="mb-6">
                        <h3 class="text-xl text-blue-600 font-semibold mb-3">Program 1: Student Management Procedures</h3>
                        <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                            <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                            <pre><code class="language-sql">
-- Create student table
CREATE TABLE students (
    student_id NUMBER PRIMARY KEY,
    name VARCHAR2(50),
    marks NUMBER
);

-- Procedure to add new student
CREATE OR REPLACE PROCEDURE add_student (
    p_id IN NUMBER,
    p_name IN VARCHAR2,
    p_marks IN NUMBER,
    p_status OUT VARCHAR2
) IS
BEGIN
    INSERT INTO students VALUES (p_id, p_name, p_marks);
    p_status := 'Student added successfully';
    COMMIT;
EXCEPTION
    WHEN DUP_VAL_ON_INDEX THEN
        p_status := 'Error: Student ID already exists';
    WHEN OTHERS THEN
        p_status := 'Error: ' || SQLERRM;
END;
/

-- Procedure to get student details
CREATE OR REPLACE PROCEDURE get_student_details (
    p_id IN NUMBER,
    p_name OUT VARCHAR2,
    p_marks OUT NUMBER,
    p_grade OUT CHAR
) IS
BEGIN
    SELECT name, marks INTO p_name, p_marks
    FROM students
    WHERE student_id = p_id;
    
    -- Calculate grade
    p_grade := 
        CASE 
            WHEN p_marks >= 90 THEN 'A'
            WHEN p_marks >= 80 THEN 'B'
            WHEN p_marks >= 70 THEN 'C'
            ELSE 'F'
        END;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_name := NULL;
        p_marks := NULL;
        p_grade := 'X';
END;
/

-- Test the procedures
DECLARE
    v_status VARCHAR2(100);
    v_name VARCHAR2(50);
    v_marks NUMBER;
    v_grade CHAR;
BEGIN
    -- Add new student
    add_student(1, 'John Doe', 85, v_status);
    DBMS_OUTPUT.PUT_LINE(v_status);
    
    -- Get student details
    get_student_details(1, v_name, v_marks, v_grade);
    DBMS_OUTPUT.PUT_LINE('Student: ' || v_name);
    DBMS_OUTPUT.PUT_LINE('Marks: ' || v_marks);
    DBMS_OUTPUT.PUT_LINE('Grade: ' || v_grade);
END;
/</code></pre>
                        </div>
                    </div>

                    <!-- Program 2: Calculator Procedures -->
                    <div class="mb-6">
                        <h3 class="text-xl text-green-600 font-semibold mb-3">Program 2: Calculator Procedures</h3>
                        <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                            <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                            <pre><code class="language-sql">
CREATE OR REPLACE PROCEDURE calculate_numbers (
    p_num1 IN NUMBER,
    p_num2 IN NUMBER,
    p_operation IN VARCHAR2,
    p_result OUT NUMBER,
    p_status OUT VARCHAR2
) IS
BEGIN
    p_result := 
        CASE p_operation
            WHEN 'ADD' THEN p_num1 + p_num2
            WHEN 'SUB' THEN p_num1 - p_num2
            WHEN 'MUL' THEN p_num1 * p_num2
            WHEN 'DIV' THEN 
                CASE 
                    WHEN p_num2 = 0 THEN NULL
                    ELSE p_num1 / p_num2
                END
        END;
        
    IF p_result IS NULL THEN
        p_status := 'Error: Invalid operation or division by zero';
    ELSE
        p_status := 'Calculation successful';
    END IF;
EXCEPTION
    WHEN OTHERS THEN
        p_status := 'Error: ' || SQLERRM;
        p_result := NULL;
END;
/

-- Test the calculator
DECLARE
    v_result NUMBER;
    v_status VARCHAR2(100);
BEGIN
    -- Test addition
    calculate_numbers(10, 5, 'ADD', v_result, v_status);
    DBMS_OUTPUT.PUT_LINE('10 + 5 = ' || v_result);
    DBMS_OUTPUT.PUT_LINE(v_status);
    
    -- Test division by zero
    calculate_numbers(10, 0, 'DIV', v_result, v_status);
    DBMS_OUTPUT.PUT_LINE('10 / 0 = ' || v_result);
    DBMS_OUTPUT.PUT_LINE(v_status);
END;
/</code></pre>
                        </div>
                    </div>

                    <!-- Output Section -->
                    <section class="mb-8">
                        <h2 class="text-xl md:text-2xl font-semibold text-gray-700 mb-4">Sample Outputs</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                                <h3 class="text-green-800 font-semibold mb-2">Program 1 Output:</h3>
                                <pre class="text-green-800">
Student added successfully
Student: John Doe
Marks: 85
Grade: B</pre>
                            </div>
                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                                <h3 class="text-green-800 font-semibold mb-2">Program 2 Output:</h3>
                                <pre class="text-green-800">
10 + 5 = 15
Calculation successful
10 / 0 = 
Error: Invalid operation or division by zero</pre>
                            </div>
                        </div>
                    </section>
                </section>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
</body>
</html>