<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Lab Experiments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Prism CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    
    <style>
        .token.keyword { color: #569CD6; }
        .token.string { color: #CE9178; }
        .token.number { color: #B5CEA8; }
        .token.function { color: #DCDCAA; }
        .language-sql { color: #D4D4D4; }
        pre[class*="language-"] {
            background: #1E1E1E !important;
            margin: 0;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex flex-col md:flex-row min-h-screen">
        <div id="sidebar" class="hidden md:block w-full md:w-72 bg-gradient-to-b from-gray-800 to-gray-900 text-white p-6 shadow-xl">
            <!-- Sidebar content will be generated by JavaScript -->
        </div>

        <div class="flex-1 p-4 md:p-8 overflow-y-auto">
            <div class="max-w-4xl mx-auto">
                <!-- Header -->
                <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-8">
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Experiment 6: Transaction Control in PL/SQL</h1>
                    <div class="flex flex-col md:flex-row items-start md:items-center text-sm text-gray-500">
                        <span class="mb-2 md:mb-0 md:mr-4">üìÖ Date: May 5, 2025</span>
                        <span>‚è±Ô∏è Duration: 2 hours</span>
                    </div>
                </div>

                <!-- Aim Section -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Aim</h2>
                    <p class="text-gray-600">
                        To understand and implement transaction control statements (COMMIT, ROLLBACK, SAVEPOINT) in PL/SQL blocks while performing operations on a student table.
                    </p>
                </section>

                <!-- Theory Section -->
                <section class="mb-8 bg-white p-6 rounded-lg shadow-lg">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Theory</h2>
                    <div class="space-y-4">
                        <p class="text-gray-600">
                            Transaction control statements manage changes made by DML statements and group DML statements into logical transactions. Oracle Database supports the following transaction control statements:
                        </p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <h3 class="text-blue-600 font-semibold mb-2">COMMIT</h3>
                                <p class="text-gray-600">Ends current transaction by making all pending changes permanent</p>
                            </div>

                            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <h3 class="text-red-600 font-semibold mb-2">ROLLBACK</h3>
                                <p class="text-gray-600">Undoes all changes made in the current transaction</p>
                            </div>

                            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <h3 class="text-green-600 font-semibold mb-2">SAVEPOINT</h3>
                                <p class="text-gray-600">Creates points in a transaction to which you can roll back</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Sample Tables -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Sample Database</h2>
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
-- Create student table
CREATE TABLE student (
    student_id NUMBER PRIMARY KEY,
    name VARCHAR2(50),
    age NUMBER,
    course VARCHAR2(50)
);

-- Initial data
INSERT INTO student VALUES (1, 'John Doe', 20, 'Computer Science');
INSERT INTO student VALUES (2, 'Jane Smith', 21, 'Electronics');
COMMIT;</code></pre>
                    </div>
                </section>

                <!-- Experiment Code -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">PL/SQL Transaction Control Examples</h2>
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
-- Example 1: Basic Transaction Control
DECLARE
    v_id NUMBER := 3;
BEGIN
    -- Insert new student
    INSERT INTO student VALUES (v_id, 'Mike Johnson', 19, 'Physics');
    
    -- Create savepoint
    SAVEPOINT after_insert;
    
    -- Update age
    UPDATE student SET age = 20 WHERE student_id = v_id;
    
    -- Demonstrate rollback to savepoint
    ROLLBACK TO SAVEPOINT after_insert;
    
    -- Commit the transaction
    COMMIT;
    
    DBMS_OUTPUT.PUT_LINE('Transaction completed successfully');
EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        DBMS_OUTPUT.PUT_LINE('Error occurred. Transaction rolled back');
END;
/

-- Example 2: Multiple Savepoints
DECLARE
    v_id NUMBER := 4;
BEGIN
    -- First insert
    INSERT INTO student VALUES (v_id, 'Sarah Wilson', 22, 'Mathematics');
    SAVEPOINT first_insert;
    
    -- Second insert
    INSERT INTO student VALUES (v_id + 1, 'Robert Brown', 21, 'Chemistry');
    SAVEPOINT second_insert;
    
    -- Update that will be rolled back
    UPDATE student SET age = 25 WHERE student_id = v_id;
    
    -- Rollback to second insert
    ROLLBACK TO SAVEPOINT second_insert;
    
    COMMIT;
END;
/</code></pre>
                    </div>
                </section>

                <!-- Output Section -->
                <section class="mb-8">
                    <h2 class="text-xl md:text-2xl font-semibold text-gray-700 mb-4">Sample Output</h2>
                    <div class="grid grid-cols-1 gap-4">
                        <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                            <h3 class="text-green-800 font-semibold mb-2">Query Result After Transactions</h3>
                            <pre class="text-green-800">
SQL> SELECT * FROM student ORDER BY student_id;

STUDENT_ID  NAME           AGE  COURSE
----------------------------------------------
1           John Doe       20   Computer Science
2           Jane Smith     21   Electronics
3           Mike Johnson   19   Physics
4           Sarah Wilson   22   Mathematics
5           Robert Brown   21   Chemistry</pre>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
</body>
</html>