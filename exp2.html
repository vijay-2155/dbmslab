<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Lab Experiments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-sql.min.js" defer></script>
    <script src="js/main.js" defer></script>
</head>
<body class="bg-gray-50">
    <!-- Same header and sidebar structure as exp1.html -->
    <div class="flex flex-col md:flex-row min-h-screen">
        <div id="sidebar" class="hidden md:block w-full md:w-72 bg-gradient-to-b from-gray-800 to-gray-900 text-white p-6 shadow-xl">
            <!-- Sidebar content will be generated by JavaScript -->
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-4 md:p-8 overflow-y-auto">
            <div id="exp2" class="max-w-4xl mx-auto">
                <!-- Header -->
                <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-8">
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Experiment 2: Advanced SQL Queries</h1>
                    <div class="flex flex-col md:flex-row items-start md:items-center text-sm text-gray-500">
                        <span class="mb-2 md:mb-0 md:mr-4">üìÖ Date: May 5, 2025</span>
                        <span>‚è±Ô∏è Duration: 3 hours</span>
                    </div>
                </div>

                <!-- Aim Section -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Aim</h2>
                    <p class="text-gray-600">
                        To understand and implement advanced SQL queries using ANY, ALL, IN, EXISTS, NOT EXISTS, UNION, INTERSECT, and subqueries to solve complex database problems.
                    </p>
                </section>

                <!-- Sample Tables -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Sample Database Setup</h2>
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative code-block">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
CREATE TABLE STUDENT (
    ROLL_NO NUMBER PRIMARY KEY,
    NAME VARCHAR2(50) NOT NULL,
    CLASS VARCHAR2(10),
    MARKS NUMBER,
    DEPARTMENT VARCHAR2(30)
);

CREATE TABLE COURSE (
    COURSE_ID VARCHAR2(10) PRIMARY KEY,
    COURSE_NAME VARCHAR2(50) NOT NULL,
    CREDITS NUMBER,
    DEPT_NAME VARCHAR2(30)
);

CREATE TABLE ENROLLMENT (
    ROLL_NO NUMBER,
    COURSE_ID VARCHAR2(10),
    GRADE VARCHAR2(2),
    PRIMARY KEY (ROLL_NO, COURSE_ID),
    FOREIGN KEY (ROLL_NO) REFERENCES STUDENT(ROLL_NO),
    FOREIGN KEY (COURSE_ID) REFERENCES COURSE(COURSE_ID)
);
                        </code></pre>
                    </div>

                    <!-- Sample Data -->
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative code-block">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
-- Insert Student Data
INSERT INTO STUDENT VALUES (101, 'John Smith', 'BE-3', 85, 'Computer Science');
INSERT INTO STUDENT VALUES (102, 'Mary Johnson', 'BE-3', 92, 'Computer Science');
INSERT INTO STUDENT VALUES (103, 'David Wilson', 'BE-3', 78, 'Computer Science');
INSERT INTO STUDENT VALUES (104, 'Sarah Brown', 'BE-3', 95, 'Computer Science');
INSERT INTO STUDENT VALUES (105, 'Michael Lee', 'BE-3', 88, 'Computer Science');

-- Insert Course Data
INSERT INTO COURSE VALUES ('CS301', 'Database Management', 4, 'Computer Science');
INSERT INTO COURSE VALUES ('CS302', 'Data Structures', 4, 'Computer Science');
INSERT INTO COURSE VALUES ('CS303', 'Operating Systems', 3, 'Computer Science');

-- Insert Enrollment Data
INSERT INTO ENROLLMENT VALUES (101, 'CS301', 'A');
INSERT INTO ENROLLMENT VALUES (101, 'CS302', 'B');
INSERT INTO ENROLLMENT VALUES (102, 'CS301', 'A');
INSERT INTO ENROLLMENT VALUES (103, 'CS303', 'B');
INSERT INTO ENROLLMENT VALUES (104, 'CS301', 'A');
                        </code></pre>
                    </div>

                    <!-- Advanced Queries -->
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative code-block">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
-- Find student with fourth highest marks (using Subquery)
SELECT ROLL_NO, NAME, MARKS
FROM (
    SELECT ROLL_NO, NAME, MARKS, 
           DENSE_RANK() OVER (ORDER BY MARKS DESC) AS RANK
    FROM STUDENT
)
WHERE RANK = 4;

-- Find students who scored more than ALL students in BE-3
SELECT NAME, MARKS
FROM STUDENT
WHERE MARKS > ALL (
    SELECT MARKS FROM STUDENT 
    WHERE CLASS = 'BE-3' AND MARKS < 95
);

-- Find courses taken by any student who got an 'A' grade
SELECT DISTINCT C.COURSE_NAME
FROM COURSE C
WHERE C.COURSE_ID = ANY (
    SELECT COURSE_ID 
    FROM ENROLLMENT 
    WHERE GRADE = 'A'
);

-- Find students who exist in both CS301 and CS302 courses
SELECT S.NAME
FROM STUDENT S
WHERE EXISTS (
    SELECT 1 FROM ENROLLMENT E1
    WHERE E1.ROLL_NO = S.ROLL_NO 
    AND E1.COURSE_ID = 'CS301'
) AND EXISTS (
    SELECT 1 FROM ENROLLMENT E2
    WHERE E2.ROLL_NO = S.ROLL_NO 
    AND E2.COURSE_ID = 'CS302'
);

-- Union of students from CS301 and CS302
SELECT S.NAME, E.COURSE_ID
FROM STUDENT S JOIN ENROLLMENT E ON S.ROLL_NO = E.ROLL_NO
WHERE E.COURSE_ID = 'CS301'
UNION
SELECT S.NAME, E.COURSE_ID
FROM STUDENT S JOIN ENROLLMENT E ON S.ROLL_NO = E.ROLL_NO
WHERE E.COURSE_ID = 'CS302';
                        </code></pre>
                    </div>
                </section>

                <!-- Theory Section -->
                <section class="mb-8 bg-white p-6 rounded-lg shadow-lg">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Theory</h2>
                    <div class="space-y-4">
                        <div class="prose max-w-none">
                            <p class="text-gray-600 mb-4">
                                Advanced SQL queries allow us to perform complex data retrieval operations using various clauses and operators:
                            </p>
                            
                            <!-- Syntax Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <h3 class="text-blue-600 font-semibold mb-2">ANY and ALL Operators</h3>
                                    <div class="bg-[#1e1e1e] rounded-md p-3">
                                        <pre><code class="language-sql text-sm">
SELECT column_name
FROM table_name
WHERE column_name > ANY (subquery);

SELECT column_name
FROM table_name
WHERE column_name > ALL (subquery);</code></pre>
                                    </div>
                                </div>

                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <h3 class="text-green-600 font-semibold mb-2">EXISTS and NOT EXISTS</h3>
                                    <div class="bg-[#1e1e1e] rounded-md p-3">
                                        <pre><code class="language-sql text-sm">
SELECT column_name
FROM table_name
WHERE EXISTS (subquery);

SELECT column_name
FROM table_name
WHERE NOT EXISTS (subquery);</code></pre>
                                    </div>
                                </div>

                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <h3 class="text-purple-600 font-semibold mb-2">UNION and INTERSECT</h3>
                                    <div class="bg-[#1e1e1e] rounded-md p-3">
                                        <pre><code class="language-sql text-sm">
SELECT column_name FROM table1
UNION
SELECT column_name FROM table2;

SELECT column_name FROM table1
INTERSECT
SELECT column_name FROM table2;</code></pre>
                                    </div>
                                </div>

                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <h3 class="text-orange-600 font-semibold mb-2">Subqueries with IN</h3>
                                    <div class="bg-[#1e1e1e] rounded-md p-3">
                                        <pre><code class="language-sql text-sm">
SELECT column_name
FROM table_name
WHERE column_name IN (
    SELECT column_name
    FROM table_name
    WHERE condition
);</code></pre>
                                    </div>
                                </div>
                            </div>

                            <!-- Key Points -->
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h3 class="text-blue-800 font-semibold mb-2">Key Points:</h3>
                                <ul class="list-disc list-inside text-gray-700 space-y-2">
                                    <li>ANY returns true if any subquery value meets the condition</li>
                                    <li>ALL returns true if all subquery values meet the condition</li>
                                    <li>EXISTS checks for the existence of rows in a subquery</li>
                                    <li>UNION combines results from multiple SELECT statements</li>
                                    <li>INTERSECT returns only common rows between queries</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Output Section -->
                <section class="mb-8">
                    <h2 class="text-xl md:text-2xl font-semibold text-gray-700 mb-4">Sample Output</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                            <h3 class="text-green-800 font-semibold mb-2">Fourth Rank Student</h3>
                            <pre class="text-green-800">
ROLL_NO  NAME           MARKS
--------------------------------
103      David Wilson   78
                            </pre>
                        </div>
                        <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                            <h3 class="text-green-800 font-semibold mb-2">Students in Both CS301 and CS302</h3>
                            <pre class="text-green-800">
NAME
----------------
John Smith
                            </pre>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Same JavaScript as exp1.html -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Highlight all code blocks
            if (typeof Prism !== 'undefined') {
                Prism.highlightAll();
            }
            
            // Copy functionality is handled by main.js
        });
    </script>
</body>
</html>
