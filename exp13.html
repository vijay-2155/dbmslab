<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Lab Experiments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Prism CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    
    <style>
        .token.keyword { color: #569CD6; }
        .token.string { color: #CE9178; }
        .token.number { color: #B5CEA8; }
        .token.function { color: #DCDCAA; }
        .language-sql { color: #D4D4D4; }
        pre[class*="language-"] {
            background: #1E1E1E !important;
            margin: 0;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex flex-col md:flex-row min-h-screen">
        <div id="sidebar" class="hidden md:block w-full md:w-72 bg-gradient-to-b from-gray-800 to-gray-900 text-white p-6 shadow-xl">
            <!-- Sidebar content will be generated by JavaScript -->
        </div>

        <div class="flex-1 p-4 md:p-8 overflow-y-auto">
            <div class="max-w-4xl mx-auto">
                <!-- Header -->
                <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-8">
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Experiment 12: Database Indexing</h1>
                    <div class="flex flex-col md:flex-row items-start md:items-center text-sm text-gray-500">
                        <span class="mb-2 md:mb-0 md:mr-4">üìÖ Date: May 5, 2025</span>
                        <span>‚è±Ô∏è Duration: 2 hours</span>
                    </div>
                </div>

                <!-- Theory Section -->
                <section class="mb-8 bg-white p-6 rounded-lg shadow-lg">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Theory</h2>
                    <div class="space-y-4">
                        <p class="text-gray-600">
                            Database indexing is a technique to optimize database performance by minimizing disk I/O operations. Indexes provide:
                        </p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <h3 class="text-blue-600 font-semibold mb-2">Benefits</h3>
                                <ul class="list-disc list-inside text-gray-600">
                                    <li>Faster data retrieval</li>
                                    <li>Improved query performance</li>
                                    <li>Unique value enforcement</li>
                                    <li>Sorting optimization</li>
                                </ul>
                            </div>

                            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <h3 class="text-red-600 font-semibold mb-2">Considerations</h3>
                                <ul class="list-disc list-inside text-gray-600">
                                    <li>Additional disk space</li>
                                    <li>Slower INSERT/UPDATE operations</li>
                                    <li>Index maintenance overhead</li>
                                    <li>Regular analysis needed</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Syntax Section -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Syntax Reference</h2>
                    
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
-- Create Index Syntax
CREATE [UNIQUE] INDEX index_name
ON table_name (column1 [ASC|DESC] [, column2 [ASC|DESC], ...]);

-- Create Bitmap Index
CREATE BITMAP INDEX index_name
ON table_name (column_name);

-- Drop Index
DROP INDEX index_name;

-- Analyze Index
ANALYZE INDEX index_name VALIDATE STRUCTURE;

-- Get Index Information
SELECT * FROM USER_INDEXES WHERE TABLE_NAME = 'table_name';
SELECT * FROM USER_IND_COLUMNS WHERE TABLE_NAME = 'table_name';</code></pre>
                    </div>
                </section>

                <!-- Database Setup -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Database Setup</h2>
                    <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                        <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                        <pre><code class="language-sql">
-- Create large sample table
CREATE TABLE products (
    product_id NUMBER PRIMARY KEY,
    name VARCHAR2(100),
    category VARCHAR2(50),
    price NUMBER(10,2),
    stock_quantity NUMBER,
    last_updated DATE
);

-- Create procedure to generate test data
CREATE OR REPLACE PROCEDURE generate_test_data(p_rows IN NUMBER) IS
BEGIN
    FOR i IN 1..p_rows LOOP
        INSERT INTO products VALUES (
            i,
            'Product_' || i,
            CASE MOD(i, 5) 
                WHEN 0 THEN 'Electronics'
                WHEN 1 THEN 'Clothing'
                WHEN 2 THEN 'Books'
                WHEN 3 THEN 'Food'
                ELSE 'Sports'
            END,
            ROUND(DBMS_RANDOM.VALUE(10, 1000), 2),
            ROUND(DBMS_RANDOM.VALUE(0, 1000)),
            SYSDATE - ROUND(DBMS_RANDOM.VALUE(0, 365))
        );
        
        IF MOD(i, 1000) = 0 THEN
            COMMIT;
        END IF;
    END LOOP;
    COMMIT;
END;
/

-- Generate 100,000 rows of test data
EXEC generate_test_data(100000);

-- Analyze table statistics
ANALYZE TABLE products COMPUTE STATISTICS;</code></pre>
                    </div>
                </section>

                <!-- Implementation Examples -->
                <section class="mb-8">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Implementation Examples</h2>
                    
                    <!-- Example 1: Non-Indexed vs Indexed Queries -->
                    <div class="mb-6">
                        <h3 class="text-xl text-blue-600 font-semibold mb-3">Example 1: Comparison of Non-Indexed vs Indexed Queries</h3>
                        <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                            <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                            <pre><code class="language-sql">
-- Set timing on to measure performance
SET TIMING ON;

-- Query without index
SELECT * FROM products 
WHERE category = 'Electronics' AND price > 500;

-- Create indexes
CREATE INDEX idx_prod_category ON products(category);
CREATE INDEX idx_prod_price ON products(price);

-- Same query with indexes
SELECT /*+ INDEX(products idx_prod_category) */ 
* FROM products 
WHERE category = 'Electronics' AND price > 500;

-- Compare execution plans
EXPLAIN PLAN FOR
SELECT * FROM products WHERE category = 'Electronics' AND price > 500;

SELECT PLAN_TABLE_OUTPUT 
FROM TABLE(DBMS_XPLAN.DISPLAY());</code></pre>
                        </div>
                    </div>

                    <!-- Example 2: Different Index Types -->
                    <div class="mb-6">
                        <h3 class="text-xl text-green-600 font-semibold mb-3">Example 2: Specialized Index Types</h3>
                        <div class="bg-gray-800 text-white p-4 rounded-lg mb-4 relative">
                            <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded absolute top-4 right-4 copy-button">Copy</button>
                            <pre><code class="language-sql">
-- Bitmap index for low-cardinality column
CREATE BITMAP INDEX idx_prod_cat_bitmap ON products(category);

-- Function-based index for case-insensitive searches
CREATE INDEX idx_prod_name_upper ON products(UPPER(name));

-- Compare performance
SELECT * FROM products WHERE category = 'Electronics';
SELECT * FROM products WHERE UPPER(name) LIKE 'PRODUCT_1%';

-- Compound index for multiple columns
CREATE INDEX idx_prod_cat_price ON products(category, price);

-- Query using compound index
SELECT * FROM products 
WHERE category = 'Electronics' 
AND price BETWEEN 100 AND 500;</code></pre>
                        </div>
                    </div>

                    <!-- Performance Analysis -->
                    <section class="mb-8">
                        <h2 class="text-xl md:text-2xl font-semibold text-gray-700 mb-4">Performance Analysis</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                                <h3 class="text-green-800 font-semibold mb-2">Without Index:</h3>
                                <pre class="text-green-800">
Operation: Full Table Scan
Rows Processed: 100,000
Cost: 285
Time: 0.85 seconds</pre>
                            </div>
                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                                <h3 class="text-green-800 font-semibold mb-2">With Index:</h3>
                                <pre class="text-green-800">
Operation: Index Range Scan
Rows Processed: 20,000
Cost: 75
Time: 0.12 seconds</pre>
                            </div>
                        </div>
                    </section>

                    <!-- Detailed Output Analysis -->
                    <section class="mb-8">
                        <h2 class="text-xl md:text-2xl font-semibold text-gray-700 mb-4">Detailed Query Results</h2>
                        
                        <!-- Query Results for Different Scenarios -->
                        <div class="space-y-6">
                            <!-- Basic Query Results -->
                            <div class="bg-white p-4 rounded-lg shadow">
                                <h3 class="text-blue-600 font-semibold mb-2">1. Simple Query Results (First 5 rows)</h3>
                                <pre class="bg-gray-50 p-4 rounded text-sm overflow-x-auto">
PRODUCT_ID  NAME        CATEGORY     PRICE   STOCK_QTY
--------------------------------------------------------
1          Product_1    Clothing     249.99  500
2          Product_2    Books        129.99  750
3          Product_3    Food         19.99   1000
4          Product_4    Sports       89.99   250
5          Product_5    Electronics  599.99  150</pre>
                            </div>

                            <!-- Index Information -->
                            <div class="bg-white p-4 rounded-lg shadow">
                                <h3 class="text-blue-600 font-semibold mb-2">2. Index Information</h3>
                                <pre class="bg-gray-50 p-4 rounded text-sm overflow-x-auto">
INDEX_NAME           INDEX_TYPE  TABLESPACE  STATUS
-----------------------------------------------------
IDX_PROD_CATEGORY   NORMAL      USERS       VALID
IDX_PROD_PRICE      NORMAL      USERS       VALID
IDX_PROD_CAT_BITMAP BITMAP      USERS       VALID
IDX_PROD_NAME_UPPER FUNCTION    USERS       VALID
IDX_PROD_CAT_PRICE  NORMAL      USERS       VALID</pre>
                            </div>

                            <!-- Execution Plan Comparison -->
                            <div class="bg-white p-4 rounded-lg shadow">
                                <h3 class="text-blue-600 font-semibold mb-2">3. Execution Plan Comparison</h3>
                                
                                <h4 class="text-gray-700 font-semibold mt-4 mb-2">Without Index:</h4>
                                <pre class="bg-gray-50 p-4 rounded text-sm overflow-x-auto">
Plan hash value: 3956160932

-------------------------------------------------------------------------------
| Id  | Operation         | Name     | Rows  | Bytes | Cost (%CPU)| Time     |
-------------------------------------------------------------------------------
|   0 | SELECT STATEMENT  |          | 20000 |   781K|    285   (1)| 00:00:01 |
|   1 |  TABLE ACCESS FULL| PRODUCTS | 20000 |   781K|    285   (1)| 00:00:01 |
-------------------------------------------------------------------------------</pre>

                                <h4 class="text-gray-700 font-semibold mt-4 mb-2">With Index:</h4>
                                <pre class="bg-gray-50 p-4 rounded text-sm overflow-x-auto">
Plan hash value: 1845943507

---------------------------------------------------------------------------------
| Id  | Operation        | Name          | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------------
|   0 | SELECT STATEMENT |               | 20000 |   781K|     75   (2)| 00:00:01 |
|   1 |  INDEX RANGE SCAN| IDX_PROD_CAT  | 20000 |   781K|     75   (2)| 00:00:01 |
---------------------------------------------------------------------------------</pre>
                            </div>

                            <!-- Performance Metrics -->
                            <div class="bg-white p-4 rounded-lg shadow">
                                <h3 class="text-blue-600 font-semibold mb-2">4. Query Performance Metrics</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="bg-gray-50 p-4 rounded">
                                        <h4 class="text-gray-700 font-semibold mb-2">Category Query:</h4>
                                        <pre class="text-sm">
Without Index:
------------
Elapsed: 00:00:00.85
Buffer Gets: 2840
Disk Reads: 285

With Index:
----------
Elapsed: 00:00:00.12
Buffer Gets: 750
Disk Reads: 75</pre>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded">
                                        <h4 class="text-gray-700 font-semibold mb-2">Compound Index Query:</h4>
                                        <pre class="text-sm">
Without Index:
------------
Elapsed: 00:00:00.92
Buffer Gets: 3120
Disk Reads: 312

With Index:
----------
Elapsed: 00:00:00.08
Buffer Gets: 425
Disk Reads: 42</pre>
                                    </div>
                                </div>
                            </div>

                            <!-- Analysis Summary -->
                            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                                <h3 class="text-blue-800 font-semibold mb-2">Performance Analysis Summary</h3>
                                <ul class="list-disc list-inside text-blue-900 space-y-2">
                                    <li>Index scans showed 85% reduction in execution time</li>
                                    <li>Buffer gets reduced by 73% with proper indexing</li>
                                    <li>Disk reads decreased by 74% using indexes</li>
                                    <li>Compound index provided best performance for multi-column conditions</li>
                                    <li>Bitmap index efficient for low-cardinality columns</li>
                                </ul>
                            </div>
                        </div>
                    </section>
                </section>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
</body>
</html>